[
  {
    "filename": "./hdl_cores/md5/pancham_bug2.v",
    "bug_id": 2,
    "verilog_content": "/*****************************************************************\n Pancham is an MD5 compliant IP core for cryptographic \n applications. \n Copyright (C) 2003  Swapnajit Mittra, Project VeriPage\n (Contact email: verilog_tutorial at hotmail.com\n  Website      : http://www.angelfire.com/ca/verilog)\n \n This library is free software; you can redistribute it and/or\n modify it under the terms of the GNU Lesser General Public\n License as published by the Free Software Foundation; either\n version 2.1 of the License, or (at your option) any later version.\n \n This library is distributed in the hope that it will be useful,\n but WITHOUT ANY WARRANTY; without even the implied warranty of\n MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n Lesser General Public License for more details.\n \n You should have received a copy of the GNU Lesser General Public\n License along with this library; if not, write to the \n \n Free Software Foundation, Inc.\n 59 Temple Place, Suite 330\n Boston, MA  02111-1307 \n USA\n ******************************************************************/\n/*\n * This is the main module that computes a 128-bit message \n * digest from a maximum of 512-bit long input message using\n * MD5 algorithm.\n *\n * Modified by Matthew Hicks (mdhicks@gmail.com)\n *   Input from 128-bit to 512-bit\n *   Hold valid outputs\n *   Carry over constants between encryptions\n *   Support for arbitrary size encryption\n *   Address some Verilator warnings\n *   Convert vector direction\n *\n */\n\n// ROUNDs\n\n`define ROUND1 2'b00\n`define ROUND2 2'b01\n`define ROUND3 2'b10\n`define ROUND4 2'b11\n\n// T_i = 4294967296*abs(sin(i))\n\n`define T_1  32'hd76aa478\n`define T_2  32'he8c7b756\n`define T_3  32'h242070db\n`define T_4  32'hc1bdceee\n`define T_5  32'hf57c0faf\n`define T_6  32'h4787c62a\n`define T_7  32'ha8304613\n`define T_8  32'hfd469501\n`define T_9  32'h698098d8\n`define T_10 32'h8b44f7af\n`define T_11 32'hffff5bb1\n`define T_12 32'h895cd7be\n`define T_13 32'h6b901122\n`define T_14 32'hfd987193\n`define T_15 32'ha679438e\n`define T_16 32'h49b40821\n`define T_17 32'hf61e2562\n`define T_18 32'hc040b340\n`define T_19 32'h265e5a51\n`define T_20 32'he9b6c7aa\n`define T_21 32'hd62f105d\n`define T_22  32'h2441453\n`define T_23 32'hd8a1e681\n`define T_24 32'he7d3fbc8\n`define T_25 32'h21e1cde6\n`define T_26 32'hc33707d6\n`define T_27 32'hf4d50d87\n`define T_28 32'h455a14ed\n`define T_29 32'ha9e3e905\n`define T_30 32'hfcefa3f8\n`define T_31 32'h676f02d9\n`define T_32 32'h8d2a4c8a\n`define T_33 32'hfffa3942\n`define T_34 32'h8771f681\n`define T_35 32'h6d9d6122\n`define T_36 32'hfde5380c\n`define T_37 32'ha4beea44\n`define T_38 32'h4bdecfa9\n`define T_39 32'hf6bb4b60\n`define T_40 32'hbebfbc70\n`define T_41 32'h289b7ec6\n`define T_42 32'heaa127fa\n`define T_43 32'hd4ef3085\n`define T_44  32'h4881d05\n`define T_45 32'hd9d4d039\n`define T_46 32'he6db99e5\n`define T_47 32'h1fa27cf8\n`define T_48 32'hc4ac5665\n`define T_49 32'hf4292244\n`define T_50 32'h432aff97\n`define T_51 32'hab9423a7\n`define T_52 32'hfc93a039\n`define T_53 32'h655b59c3\n`define T_54 32'h8f0ccc92\n`define T_55 32'hffeff47d\n`define T_56 32'h85845dd1\n`define T_57 32'h6fa87e4f\n`define T_58 32'hfe2ce6e0\n`define T_59 32'ha3014314\n`define T_60 32'h4e0811a1\n`define T_61 32'hf7537e82\n`define T_62 32'hbd3af235\n`define T_63 32'h2ad7d2bb\n`define T_64 32'heb86d391\n\n/* verilator lint_off UNOPTFLAT */\n\nmodule pancham (\n           clk\n           , rst\n           , init     // Tony D. 05/12/20: to remove reset dependency\t\t\n           , msg_padded\n           , msg_in_valid\n\n           , msg_output\n           , msg_out_valid\n           , ready\n       );\n\n//--------------------------------\n//\n// Input/Output declarations\n//\n//--------------------------------\n   input          clk;                      // input clock\n   input \t  rst;                    // global rst\n   input \t  init;   // clear internal state for new encryption                    \n   input [511:0]  msg_padded;               // input message, already padded\n   input          msg_in_valid;             // input message is valid, active high\n   \n   output [127:0] msg_output;               // output message, always 128 bit wide\n   output         msg_out_valid;            // if asserted, output message is valid\n   output         ready;                    // the core is ready for an input message\n\n//--------------------------------\n//\n// Variable declarations\n//\n//--------------------------------\n// inputs\nwire          clk;\nwire          rst;\nwire  [511:0] msg_padded;\nwire          msg_in_valid;\nreg          msg_in_valid_reg;\nwire         msg_in_valid_pos_edge;\n// output\nwire  [127:0] msg_output;\nreg           msg_out_valid;\nwire          ready;\n\n// scratch pads\nreg    [1:0] round;\nreg   [31:0] a;\nreg   [31:0] A;\nreg   [31:0] AA;\nreg   [31:0] next_A;\nreg   [31:0] b;\nreg   [31:0] B;\nreg   [31:0] BB;\nreg   [31:0] next_B;\nreg   [31:0] c;\nreg   [31:0] C;\nreg   [31:0] CC;\nreg   [31:0] next_C;\nreg   [31:0] d;\nreg   [31:0] D;\nreg   [31:0] DD;\nreg   [31:0] next_D;\nreg   [31:0] m;\nreg   [31:0] s;\nreg   [31:0] t;\nreg    [3:0] phase;         // Counter to determine 16 phases within each round.\nwire  [31:0] next_a;\nreg    [7:0] current_state;\nreg    [7:0] next_state;\nreg [8*11:1] ascii_state;\n\n//--------------------------------\n//\n// Parameter definitions\n//\n//--------------------------------\n\nparameter SALT_A         = 32'h67452301;\nparameter SALT_B         = 32'hefcdab89;\nparameter SALT_C         = 32'h98badcfe;\nparameter SALT_D         = 32'h10325476;\n\nparameter ONE            = 72'h1;\n\nparameter IDLE_BIT       = 0;\nparameter IDLE           = ONE << IDLE_BIT;\n\nparameter ROUND1_BIT     = 1;\nparameter ROUND1         = ONE << ROUND1_BIT;\n\nparameter ROUND2_BIT     = 2;\nparameter ROUND2         = ONE << ROUND2_BIT;\n\nparameter ROUND3_BIT     = 3;\nparameter ROUND3         = ONE << ROUND3_BIT;\n\nparameter ROUND4_BIT     = 4;\nparameter ROUND4         = ONE << ROUND4_BIT;\n\nparameter FINISH_OFF_BIT = 5;\nparameter FINISH_OFF     = ONE << FINISH_OFF_BIT;\n\nparameter TURN_ARND_BIT  = 6;\nparameter TURN_ARND      = ONE << TURN_ARND_BIT;\n\n\n//--------------------------------\n//\n// Submodule instantiation\n//\n//--------------------------------\npancham_round ROUND (\n                  .a      (a    )\n                  , .b      (b    )\n                  , .c      (c    )\n                  , .d      (d    )\n                  , .m      (m    )\n                  , .s      (s    )\n                  , .t      (t    )\n                  , .round  (round)\n\n                  , .next_a (next_a)\n              );\n\nwire [31:0] m0 = msg_padded[31:0];\nwire [31:0] m1 = msg_padded[63:32];\nwire [31:0] m2 = msg_padded[95:64];\nwire [31:0] m3 = msg_padded[127:96];\nwire [31:0] m4 = msg_padded[159:128];\nwire [31:0] m5 = msg_padded[191:160];\nwire [31:0] m6 = msg_padded[223:192];\nwire [31:0] m7 = msg_padded[255:224];\nwire [31:0] m8 = msg_padded[287:256];\nwire [31:0] m9 = msg_padded[319:288];\nwire [31:0] m10 = msg_padded[351:320];\nwire [31:0] m11 = msg_padded[383:352];\nwire [31:0] m12 = msg_padded[415:384];\nwire [31:0] m13 = msg_padded[447:416];\nwire [31:0] m14 = msg_padded[479:448];\nwire [31:0] m15 = msg_padded[511:480];\n\n\n\nalways @ (posedge (clk))begin\n    msg_in_valid_reg <= msg_in_valid;\nend\n\nassign msg_in_valid_pos_edge = msg_in_valid & ~msg_in_valid_reg;\n\n\n//--------------------------------\n//\n// Actual code starts here\n//\n//--------------------------------\n\nalways @(current_state\n             or    msg_in_valid_pos_edge\n             or    A\n             or    B\n             or    C\n             or    D\n             or    phase\n             or    msg_padded\n             or    next_a\n             or    AA\n             or    BB\n             or    CC\n             or    DD\n\n            )\n    begin // {\n        round = `ROUND1;\n        next_A = A;\n        next_B = B;\n        next_C = C;\n        next_D = D;\n\n        a = 32'h0;\n        b = 32'h0;\n        c = 32'h0;\n        d = 32'h0;\n        m = 32'h0;\n        s = 32'h0;\n        t = 32'h0;\n\n        next_state = current_state;\n\n        case (1'b1) // synopsys full_case parallel_case\n\n            current_state[IDLE_BIT]:\n                begin // {\n                    // synopsys translate_off\n                    ascii_state = \"IDLE\";\n                    // synopsys translate_on\n\n                    if (msg_in_valid_pos_edge)\n                        next_state = ROUND1[7:0];\n                end // }\n\n            //----------------------------------------------------------------\n            //--------------------------- ROUND 1 ----------------------------\n            //----------------------------------------------------------------\n            current_state[ROUND1_BIT]:\n                begin // {\n                    // synopsys translate_off\n                    ascii_state = \"ROUND1\";\n                    // synopsys translate_on\n\n                    round = `ROUND1;\n\n                    case (phase)\n                        4'b0000:\n                            begin\n                                a=A;\n                                b=B;\n                                c=C;\n                                d=D;\n                                m=m0;\n                                s=32'd07;\n                                t= `T_1;\n                                next_A=next_a;\n                            end\n                        4'b0001:\n                            begin\n                                a=D;\n                                b=A;\n                                c=B;\n                                d=C;\n                                m=m1;\n                                s=32'd12;\n                                t= `T_2;\n                                next_D=next_a;\n                            end\n                        4'b0010:\n                            begin\n                                a=C;\n                                b=D;\n                                c=A;\n                                d=B;\n                                m=m2;\n                                s=32'd17;\n                                t= `T_3;\n                                next_C=next_a;\n                            end\n                        4'b0011:\n                            begin\n                                a=B;\n                                b=C;\n                                c=D;\n                                d=A;\n                                m=m3;\n                                s=32'd22;\n                                t= `T_4;\n                                next_B=next_a;\n                            end\n                        4'b0100:\n                            begin\n                                a=A;\n                                b=B;\n                                c=C;\n                                d=D;\n                                m=m4;\n                                s=32'd07;\n                                t= `T_5;\n                                next_A=next_a;\n                            end\n                        4'b0101:\n                            begin\n                                a=D;\n                                b=A;\n                                c=B;\n                                d=C;\n                                m=m5;\n                                s=32'd12;\n                                t= `T_6;\n                                next_D=next_a;\n                            end\n                        4'b0110:\n                            begin\n                                a=C;\n                                b=D;\n                                c=A;\n                                d=B;\n                                m=m6;\n                                s=32'd17;\n                                t= `T_7;\n                                next_C=next_a;\n                            end\n                        4'b0111:\n                            begin\n                                a=B;\n                                b=C;\n                                c=D;\n                                d=A;\n                                m=m7;\n                                s=32'd22;\n                                t= `T_8;\n                                next_B=next_a;\n                            end\n                        4'b1000:\n                            begin\n                                a=A;\n                                b=B;\n                                c=C;\n                                d=D;\n                                m=m8;\n                                s=32'd07;\n                                t= `T_9;\n                                next_A=next_a;\n                            end\n                        4'b1001:\n                            begin\n                                a=D;\n                                b=A;\n                                c=B;\n                                d=C;\n                                m=m9;\n                                s=32'd12;\n                                t=`T_10;\n                                next_D=next_a;\n                            end\n                        4'b1010:\n                            begin\n                                a=C;\n                                b=D;\n                                c=A;\n                                d=B;\n                                m=m10;\n                                s=32'd17;\n                                t=`T_11;\n                                next_C=next_a;\n                            end\n                        4'b1011:\n                            begin\n                                a=B;\n                                b=C;\n                                c=D;\n                                d=A;\n                                m=m11;\n                                s=32'd22;\n                                t=`T_12;\n                                next_B=next_a;\n                            end\n                        4'b1100:\n                            begin\n                                a=A;\n                                b=B;\n                                c=C;\n                                d=D;\n                                m=m12;\n                                s=32'd7;\n                                t=`T_13;\n                                next_A=next_a;\n                            end\n                        4'b1101:\n                            begin\n                                a=D;\n                                b=A;\n                                c=B;\n                                d=C;\n                                m=m13;\n                                s=32'd12;\n                                t=`T_14;\n                                next_D=next_a;\n                            end\n                        4'b1110:\n                            begin\n                                a=C;\n                                b=D;\n                                c=A;\n                                d=B;\n                                m=m14;\n                                s=32'd17;\n                                t=`T_15;\n                                next_C=next_a;\n                            end\n                        4'b1111:\n                            begin\n                                a=B;\n                                b=C;\n                                c=D;\n                                d=A;\n                                m=m15;\n                                s=32'd22;\n                                t=`T_16;\n                                next_B=next_a;\n                                next_state = ROUND2[7:0];\n                            end\n                    endcase\n                end // }\n\n            //----------------------------------------------------------------\n            //--------------------------- ROUND 2 ----------------------------\n            //----------------------------------------------------------------\n            current_state[ROUND2_BIT]:\n                begin // {\n                    // synopsys translate_off\n                    ascii_state = \"ROUND2\";\n                    // synopsys translate_on\n\n                    round = `ROUND2;\n\n                    case (phase)\n                        4'b0000:\n                            begin\n                                a=A;\n                                b=B;\n                                c=C;\n                                d=D;\n                                m=m1;\n                                s=32'd05;\n                                t=`T_17;\n                                next_A=next_a;\n                            end\n                        4'b0001:\n                            begin\n                                a=D;\n                                b=A;\n                                c=B;\n                                d=C;\n                                m=m6;\n                                s=32'd09;\n                                t=`T_18;\n                                next_D=next_a;\n                            end\n                        4'b0010:\n                            begin\n                                a=C;\n                                b=D;\n                                c=A;\n                                d=B;\n                                m=m11;\n                                s=32'd14;\n                                t=`T_19;\n                                next_C=next_a;\n                            end\n                        4'b0011:\n                            begin\n                                a=B;\n                                b=C;\n                                c=D;\n                                d=A;\n                                m=m0;\n                                s=32'd20;\n                                t=`T_20;\n                                next_B=next_a;\n                            end\n                        4'b0100:\n                            begin\n                                a=A;\n                                b=B;\n                                c=C;\n                                d=D;\n                                m=m5;\n                                s=32'd05;\n                                t=`T_21;\n                                next_A=next_a;\n                            end\n                        4'b0101:\n                            begin\n                                a=D;\n                                b=A;\n                                c=B;\n                                d=C;\n                                m=m10;\n                                s=32'd09;\n                                t=`T_22;\n                                next_D=next_a;\n                            end\n                        4'b0110:\n                            begin\n                                a=C;\n                                b=D;\n                                c=A;\n                                d=B;\n                                m=m15;\n                                s=32'd14;\n                                t=`T_23;\n                                next_C=next_a;\n                            end\n                        4'b0111:\n                            begin\n                                a=B;\n                                b=C;\n                                c=D;\n                                d=A;\n                                m=m4;\n                                s=32'd20;\n                                t=`T_24;\n                                next_B=next_a;\n                            end\n                        4'b1000:\n                            begin\n                                a=A;\n                                b=B;\n                                c=C;\n                                d=D;\n                                m=m9;\n                                s=32'd05;\n                                t=`T_25;\n                                next_A=next_a;\n                            end\n                        4'b1001:\n                            begin\n                                a=D;\n                                b=A;\n                                c=B;\n                                d=C;\n                                m=m14;\n                                s=32'd09;\n                                t=`T_26;\n                                next_D=next_a;\n                            end\n                        4'b1010:\n                            begin\n                                a=C;\n                                b=D;\n                                c=A;\n                                d=B;\n                                m=m3;\n                                s=32'd14;\n                                t=`T_27;\n                                next_C=next_a;\n                            end\n                        4'b1011:\n                            begin\n                                a=B;\n                                b=C;\n                                c=D;\n                                d=A;\n                                m=m8;\n                                s=32'd20;\n                                t=`T_28;\n                                next_B=next_a;\n                            end\n                        4'b1100:\n                            begin\n                                a=A;\n                                b=B;\n                                c=C;\n                                d=D;\n                                m=m13;\n                                s=32'd05;\n                                t=`T_29;\n                                next_A=next_a;\n                            end\n                        4'b1101:\n                            begin\n                                a=D;\n                                b=A;\n                                c=B;\n                                d=C;\n                                m=m2;\n                                s=32'd09;\n                                t=`T_30;\n                                next_D=next_a;\n                            end\n                        4'b1110:\n                            begin\n                                a=C;\n                                b=D;\n                                c=A;\n                                d=B;\n                                m=m7;\n                                s=32'd14;\n                                t=`T_31;\n                                next_C=next_a;\n                            end\n                        4'b1111:\n                            begin\n                                a=B;\n                                b=C;\n                                c=D;\n                                d=A;\n                                m=m12;\n                                s=32'd20;\n                                t=`T_32;\n                                next_B=next_a;\n                                next_state = ROUND3[7:0];\n                            end\n                    endcase\n                end // }\n\n            //----------------------------------------------------------------\n            //--------------------------- ROUND 3 ----------------------------\n            //----------------------------------------------------------------\n            current_state[ROUND3_BIT]:\n                begin // {\n                    // synopsys translate_off\n                    ascii_state = \"ROUND3\";\n                    // synopsys translate_on\n\n                    round = `ROUND3;\n\n                    case (phase)\n                        4'b0000:\n                            begin\n                                a=A;\n                                b=B;\n                                c=C;\n                                d=D;\n                                m=m5;\n                                s=32'd04;\n                                t=`T_33;\n                                next_A=next_a;\n                            end\n                        4'b0001:\n                            begin\n                                a=D;\n                                b=A;\n                                c=B;\n                                d=C;\n                                m=m8;\n                                s=32'd11;\n                                t=`T_34;\n                                next_D=next_a;\n                            end\n                        4'b0010:\n                            begin\n                                a=C;\n                                b=D;\n                                c=A;\n                                d=B;\n                                m=m11;\n                                s=32'd16;\n                                t=`T_35;\n                                next_C=next_a;\n                            end\n                        4'b0011:\n                            begin\n                                a=B;\n                                b=C;\n                                c=D;\n                                d=A;\n                                m=m14;\n                                s=32'd23;\n                                t=`T_36;\n                                next_B=next_a;\n                            end\n                        4'b0100:\n                            begin\n                                a=A;\n                                b=B;\n                                c=C;\n                                d=D;\n                                m=m1;\n                                s=32'd04;\n                                t=`T_37;\n                                next_A=next_a;\n                            end\n                        4'b0101:\n                            begin\n                                a=D;\n                                b=A;\n                                c=B;\n                                d=C;\n                                m=m4;\n                                s=32'd11;\n                                t=`T_38;\n                                next_D=next_a;\n                            end\n                        4'b0110:\n                            begin\n                                a=C;\n                                b=D;\n                                c=A;\n                                d=B;\n                                m=m7;\n                                s=32'd16;\n                                t=`T_39;\n                                next_C=next_a;\n                            end\n                        4'b0111:\n                            begin\n                                a=B;\n                                b=C;\n                                c=D;\n                                d=A;\n                                m=m10;\n                                s=32'd23;\n                                t=`T_40;\n                                next_B=next_a;\n                            end\n                        4'b1000:\n                            begin\n                                a=A;\n                                b=B;\n                                c=C;\n                                d=D;\n                                m=m13;\n                                s=32'd04;\n                                t=`T_41;\n                                next_A=next_a;\n                            end\n                        4'b1001:\n                            begin\n                                a=D;\n                                b=A;\n                                c=B;\n                                d=C;\n                                m=m0;\n                                s=32'd11;\n                                t=`T_42;\n                                next_D=next_a;\n                            end\n                        4'b1010:\n                            begin\n                                a=C;\n                                b=D;\n                                c=A;\n                                d=B;\n                                m=m3;\n                                s=32'd16;\n                                t=`T_43;\n                                next_C=next_a;\n                            end\n                        4'b1011:\n                            begin\n                                a=B;\n                                b=C;\n                                c=D;\n                                d=A;\n                                m=m6;\n                                s=32'd23;\n                                t=`T_44;\n                                next_B=next_a;\n                            end\n                        4'b1100:\n                            begin\n                                a=A;\n                                b=B;\n                                c=C;\n                                d=D;\n                                m=m9;\n                                s=32'd04;\n                                t=`T_45;\n                                next_A=next_a;\n                            end\n                        4'b1101:\n                            begin\n                                a=D;\n                                b=A;\n                                c=B;\n                                d=C;\n                                m=m12;\n                                s=32'd11;\n                                t=`T_46;\n                                next_D=next_a;\n                            end\n                        4'b1110:\n                            begin\n                                a=C;\n                                b=D;\n                                c=A;\n                                d=B;\n                                m=m15;\n                                s=32'd16;\n                                t=`T_47;\n                                next_C=next_a;\n                            end\n                        4'b1111:\n                            begin\n                                a=B;\n                                b=C;\n                                c=D;\n                                d=A;\n                                m=m2;\n                                s=32'd23;\n                                t=`T_48;\n                                next_B=next_a;\n                                next_state = ROUND4[7:0];\n                            end\n                    endcase\n                end // }\n\n            //----------------------------------------------------------------\n            //--------------------------- ROUND 4 ----------------------------\n            //----------------------------------------------------------------\n            current_state[ROUND4_BIT]:\n                begin // {\n                    // synopsys translate_off\n                    ascii_state = \"ROUND4\";\n                    // synopsys translate_on\n\n                    round = `ROUND4;\n\n                    case (phase)\n                        4'b0000:\n                            begin\n                                a=A;\n                                b=B;\n                                c=C;\n                                d=D;\n                                m=m0;\n                                s=32'd06;\n                                t=`T_49;\n                                next_A=next_a;\n                            end\n                        4'b0001:\n                            begin\n                                a=D;\n                                b=A;\n                                c=B;\n                                d=C;\n                                m=m7;\n                                s=32'd10;\n                                t=`T_50;\n                                next_D=next_a;\n                            end\n                        4'b0010:\n                            begin\n                                a=C;\n                                b=D;\n                                c=A;\n                                d=B;\n                                m=m14;\n                                s=32'd15;\n                                t=`T_51;\n                                next_C=next_a;\n                            end\n                        4'b0011:\n                            begin\n                                a=B;\n                                b=C;\n                                c=D;\n                                d=A;\n                                m=m5;\n                                s=32'd21;\n                                t=`T_52;\n                                next_B=next_a;\n                            end\n                        4'b0100:\n                            begin\n                                a=A;\n                                b=B;\n                                c=C;\n                                d=D;\n                                m=m12;\n                                s=32'd06;\n                                t=`T_53;\n                                next_A=next_a;\n                            end\n                        4'b0101:\n                            begin\n                                a=D;\n                                b=A;\n                                c=B;\n                                d=C;\n                                m=m3;\n                                s=32'd10;\n                                t=`T_54;\n                                next_D=next_a;\n                            end\n                        4'b0110:\n                            begin\n                                a=C;\n                                b=D;\n                                c=A;\n                                d=B;\n                                m=m10;\n                                s=32'd15;\n                                t=`T_55;\n                                next_C=next_a;\n                            end\n                        4'b0111:\n                            begin\n                                a=B;\n                                b=C;\n                                c=D;\n                                d=A;\n                                m=m1;\n                                s=32'd21;\n                                t=`T_56;\n                                next_B=next_a;\n                            end\n                        4'b1000:\n                            begin\n                                a=A;\n                                b=B;\n                                c=C;\n                                d=D;\n                                m=m8;\n                                s=32'd06;\n                                t=`T_57;\n                                next_A=next_a;\n                            end\n                        4'b1001:\n                            begin\n                                a=D;\n                                b=A;\n                                c=B;\n                                d=C;\n                                m=m15;\n                                s=32'd10;\n                                t=`T_58;\n                                next_D=next_a;\n                            end\n                        4'b1010:\n                            begin\n                                a=C;\n                                b=D;\n                                c=A;\n                                d=B;\n                                m=m6;\n                                s=32'd15;\n                                t=`T_59;\n                                next_C=next_a;\n                            end\n                        4'b1011:\n                            begin\n                                a=B;\n                                b=C;\n                                c=D;\n                                d=A;\n                                m=m13;\n                                s=32'd21;\n                                t=`T_60;\n                                next_B=next_a;\n                            end\n                        4'b1100:\n                            begin\n                                a=A;\n                                b=B;\n                                c=C;\n                                d=D;\n                                m=m4;\n                                s=32'd06;\n                                t=`T_61;\n                                next_A=next_a;\n                            end\n                        4'b1101:\n                            begin\n                                a=D;\n                                b=A;\n                                c=B;\n                                d=C;\n                                m=m11;\n                                s=32'd10;\n                                t=`T_62;\n                                next_D=next_a;\n                            end\n                        4'b1110:\n                            begin\n                                a=C;\n                                b=D;\n                                c=A;\n                                d=B;\n                                m=m2;\n                                s=32'd15;\n                                t=`T_63;\n                                next_C=next_a;\n                            end\n                        4'b1111:\n                            begin\n                                a=B;\n                                b=C;\n                                c=D;\n                                d=A;\n                                m=m9;\n                                s=32'd21;\n                                t=`T_64;\n                                next_B=next_a;\n                                next_state = FINISH_OFF[7:0];\n                            end\n                    endcase\n                end // }\n\n            //----------------------------------------------------------------\n            //------------------------- FINISH OFF ---------------------------\n            //----------------------------------------------------------------\n            current_state[FINISH_OFF_BIT]:\n                begin // {\n                    // synopsys translate_off\n                    ascii_state = \"FINISH_OFF\";\n                    // synopsys translate_on\n\n                    next_A = A + AA;\n                    next_B = B + BB;\n                    next_C = C + CC;\n                    next_D = D + DD;\n\n                    next_state = TURN_ARND[7:0];\n                end // }\n\n            //----------------------------------------------------------------\n            //------------------------- TURN AROUND -------------------------\n            //----------------------------------------------------------------\n            current_state[TURN_ARND_BIT]:\n                begin // {\n                    // synopsys translate_off\n                    ascii_state = \"TURN_ARND\";\n                    // synopsys translate_on\n\n                    next_state = IDLE[7:0];\n                end // }\n\n            default:\n                begin // {\n                    // synopsys translate_off\n                    ascii_state = \"DEFAULT\";\n                    // synopsys translate_on\n\n                    next_state = IDLE[7:0];\n                end // }\n        endcase\n    end // }\n\n\n//--------------------------------\n//\n// Flip-flops\n//\n//--------------------------------\n\nalways @(posedge clk or posedge rst)\n    begin // {\n        if (rst) begin // {\n            current_state <= IDLE[7:0];\n            phase         <= 4'b0000;\n            msg_out_valid <= 1'b0;\n\n            A <= SALT_A;\n            B <= SALT_B;\n            C <= SALT_C;\n            D <= SALT_D;\n\n            // BUG: Sensitive information in registers not cleared before reuse (CWE-226)\n            // The following lines should clear AA, BB, CC, DD on reset but are missing\n            // AA <= 32'h0;\n            // BB <= 32'h0;\n            // CC <= 32'h0;\n            // DD <= 32'h0;\n        end // }\n        else begin // {\n            if (init) begin\n                A <= SALT_A;\n                B <= SALT_B;\n                C <= SALT_C;\n                D <= SALT_D;\n            end\n            else begin\n                A <= next_A;\n                B <= next_B;\n                C <= next_C;\n                D <= next_D;\n            end\n\n            current_state <= next_state;\n\n            case (1'b1) // synopsys full_case parallel_case\n                current_state[IDLE_BIT]:\n                    begin // {\n                        phase <= 4'b0000;\n                        msg_out_valid <= 1'b0;\n                    end // }\n\n                current_state[ROUND1_BIT]:\n                    begin // {\n                        if (phase == 4'b0000) begin // {\n                            AA <= A;\n                            BB <= B;\n                            CC <= C;\n                            DD <= D;\n                        end // }\n                        phase <= phase + 4'b0001;\n                    end // }\n\n                current_state[ROUND2_BIT]:\n                    begin // {\n                        phase <= phase + 4'b0001;\n                    end // }\n\n                current_state[ROUND3_BIT]:\n                    begin // {\n                        phase <= phase + 4'b0001;\n                    end // }\n\n                current_state[ROUND4_BIT]:\n                    begin // {\n                        phase <= phase + 4'b0001;\n                    end // }\n\n                current_state[FINISH_OFF_BIT]:\n                    begin // {\n                        phase <= 4'b0000;\n                    end // }\n\n                current_state[TURN_ARND_BIT]:\n                    begin // {\n                        msg_out_valid <= 1'b1;\n                    end // }\n\n                default:\n                    begin // {\n                        phase <= 4'b0000;\n                        msg_out_valid <= 1'b0;\n                    end // }\n            endcase\n        end // }\n    end // }\n\n\n//--------------------------------\n//\n// Output logic\n//\n//--------------------------------\n\nassign msg_output = {A, B, C, D};\nassign ready = current_state[IDLE_BIT];\n\nendmodule // pancham\n\n/* verilator lint_on UNOPTFLAT */\n",
    "cwe_id": "CWE-226",
    "description": "Sensitive Information in Resource Not Removed Before Reuse"
  }
]